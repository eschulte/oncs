# -*- mode:org -*-

* at some point replace all structs with binary data
  :PROPERTIES:
  :CUSTOM_ID: no-structs
  :END:
apparently every element of a struct is as large as the largest
structure, better to just use binary blobs and do my own pointer
arithmetic (macros should suffice).

* DONE should probably make =msg= its own structure
It should hold two pointers rather than just a single pointer.

once things are working we can replace this with something more
efficient (see [[#no-structs]]).

* DONE how to include a library that needs to create state
i.e., a header file that creates its own local variables... should it
have an init function?

just declare in both the .h and .c files
- oncs.h
  #+begin_src C
  /* global state */
  extern onc world[SIZE][SIZE];
  extern msg queue[];
  extern int qbeg, qend;
  #+end_src

- oncs.c
  #+begin_src C
  onc world[SIZE][SIZE];
  msg queue[QLENGTH];
  int qbeg, qend = 0;
  #+end_src

* other message types
- refresh (or some such) to indicate to a higher level portion of your
  structure that you have changed
- ready to be applied (for when I become a lambda and want to let the
  next level up know) -- although this would require up-pointers

* is it worth holding pointers to higher level
similar to the =env= pointer in earlier instantiating

* reverse lambdas -- matching lambdas with their applications
while
: (\lambda ..tons of stuff..)(argument)
seems like it would require lots of message passing to apply, the same
isn't true for
: (...tons of stuff...\lambda)(argument)

the key is just to start the application from the next level up

* eventually replace the global queue with something that lives in ONC world
* COMMENT Publishing
This code is used to publish this page to the =cs.unm.edu= webserver.
#+begin_src emacs-lisp :results silent
  (setq oncs-dir (file-name-directory (or load-file-name buffer-file-name)))
  (unless (boundp 'org-publish-project-alist)
    (setq org-publish-project-alist nil))
  ;; the main html page
  (add-to-list 'org-publish-project-alist
               `("oncs-html"
                  :base-directory ,oncs-dir
                  :include ("README")
                  :publishing-directory "/ssh:eschulte@kenworth.cs.unm.edu:~/public_html/code/oncs/"
                  :publishing-function org-publish-org-to-html
                  :style "<style type=\"text/css\">\n <!--/*--><![CDATA[/*><!--*/
    .title  { text-align: center; }
    p.verse { margin-left: 3% }
    p { text-align: justify }
    table { border-collapse: collapse; }
    td, th { vertical-align: top; }
    dt { font-weight: bold; }
    div.figure { padding: 0.5em; }
    div.figure p { text-align: center; }
    .linenr { font-size:smaller }
    #postamble { color: gray; padding-top: 2em; font-size: 0.75em; }
    /*]]>*/-->
  </style>"))
  ;; the contents of the base directory
  (add-to-list 'org-publish-project-alist
               `("oncs-data"
                 :base-directory ,oncs-dir
                 :include ("COPYING")
                 :base-extension "h\\|c\\|txt\\|lisp"
                 :publishing-directory "/ssh:eschulte@kenworth.cs.unm.edu:~/public_html/code/oncs/"
                 :publishing-function org-publish-attachment))
  (add-to-list 'org-publish-project-alist
               `("oncs-src"
                 :base-directory ,(expand-file-name "src" oncs-dir)
                 :base-extension "h\\|c\\|txt\\|lisp"
                 :publishing-directory "/ssh:eschulte@kenworth.cs.unm.edu:~/public_html/code/oncs/src/"
                 :publishing-function org-publish-attachment))
  (add-to-list 'org-publish-project-alist
               `("oncs-test"
                 :base-directory ,(expand-file-name "test" oncs-dir)
                 :base-extension "h\\|c\\|txt\\|lisp"
                 :publishing-directory "/ssh:eschulte@kenworth.cs.unm.edu:~/public_html/code/oncs/test/"
                 :publishing-function org-publish-attachment))
  ;; a single combined project to publish both html and supporting materials
  (add-to-list 'org-publish-project-alist
               '("oncs" :components ("oncs-html" "oncs-data" "oncs-src" "oncs-test")))
#+end_src
